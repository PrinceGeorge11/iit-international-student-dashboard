(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[688],{7844:function(e,t,l){Promise.resolve().then(l.bind(l,2554))},2554:function(e,t,l){"use strict";l.r(t),l.d(t,{default:function(){return i}});var a=l(7437),r=l(2265),s=l(3145);let o="dzzznohpr",n="istudentshub_marketplace";function i(){let[e,t]=(0,r.useState)(null),[l,i]=(0,r.useState)(""),[d,u]=(0,r.useState)(""),[c,x]=(0,r.useState)(null),[p,f]=(0,r.useState)(null),[m,b]=(0,r.useState)(!0),[g,h]=(0,r.useState)(!1),[v,y]=(0,r.useState)(null),[j,N]=(0,r.useState)(null);(0,r.useEffect)(()=>{(async()=>{b(!0);try{let e=await fetch("/api/profile"),l=await e.json();if(!e.ok){y(l.error||"Failed to load profile.");return}let a=l.student;t(a),i(a.fullName),u(a.program),x(a.avatarUrl||null)}catch(e){console.error(e),y("Failed to load profile.")}finally{b(!1)}})()},[]);let w=async()=>{if(!p)return(null==e?void 0:e.avatarUrl)||null;if(!o||!n)return console.error("Missing Cloudinary env vars"),(null==e?void 0:e.avatarUrl)||null;let t=new FormData;t.append("file",p),t.append("upload_preset",n);let l=await fetch("https://api.cloudinary.com/v1_1/".concat(o,"/upload"),{method:"POST",body:t}),a=await l.json();return l.ok?a.secure_url:(console.error("Cloudinary upload error:",a),y("Failed to upload profile image."),(null==e?void 0:e.avatarUrl)||null)},S=async e=>{if(e.preventDefault(),y(null),N(null),!l||!d){y("Full name and program are required.");return}h(!0);try{let e=await w(),a=await fetch("/api/profile",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({fullName:l,program:d,avatarUrl:e})}),r=await a.json();if(!a.ok)throw Error(r.error||"Failed to update profile.");t(r.student),N("Profile updated successfully.")}catch(e){y(e.message||"Failed to update profile.")}finally{h(!1)}};return m?(0,a.jsx)("p",{className:"text-sm text-slate-200",children:"Loading profile…"}):e?(0,a.jsxs)("div",{className:"max-w-xl space-y-5",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs font-semibold uppercase tracking-[0.25em] text-red-300",children:"Profile"}),(0,a.jsx)("h1",{className:"mt-1 text-xl font-semibold text-slate-50",children:"Your IIT student profile"}),(0,a.jsx)("p",{className:"text-xs text-slate-400",children:"Keep your name, program, and profile photo up to date so your experience across the dashboard feels personal."})]}),(0,a.jsxs)("form",{onSubmit:S,className:"space-y-4 rounded-2xl bg-slate-950/80 p-4 ring-1 ring-slate-800",children:[v&&(0,a.jsx)("div",{className:"rounded-lg border border-red-500/60 bg-red-950/50 px-3 py-2 text-xs text-red-100",children:v}),j&&(0,a.jsx)("div",{className:"rounded-lg border border-emerald-500/60 bg-emerald-950/40 px-3 py-2 text-xs text-emerald-100",children:j}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[c?(0,a.jsx)(s.default,{src:c,alt:"Avatar",width:56,height:56,className:"h-14 w-14 rounded-full object-cover ring-2 ring-red-500/70"}):(0,a.jsx)("div",{className:"flex h-14 w-14 items-center justify-center rounded-full bg-slate-800 text-xs text-slate-400",children:"No photo"}),(0,a.jsxs)("div",{className:"flex-1 text-[11px] text-slate-300",children:[(0,a.jsx)("label",{className:"mb-1 block text-[11px] font-semibold text-slate-200",children:"Profile photo"}),(0,a.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{var t;let l=null===(t=e.target.files)||void 0===t?void 0:t[0];l&&(f(l),x(URL.createObjectURL(l)))},className:"block w-full text-[11px] text-slate-200 file:mr-3 file:rounded-md file:border-0 file:bg-red-600 file:px-3 file:py-1.5 file:text-[11px] file:font-semibold file:text-white hover:file:bg-red-500"}),(0,a.jsx)("p",{className:"mt-1 text-[10px] text-slate-500",children:"A clear, square image works best (e.g., 400\xd7400)."})]})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("label",{className:"block text-[11px] font-semibold text-slate-200",children:"Full name"}),(0,a.jsx)("input",{type:"text",value:l,onChange:e=>i(e.target.value),className:"w-full rounded-lg border border-slate-700 bg-slate-950 px-3 py-2 text-sm text-slate-100 outline-none focus:border-red-500 focus:ring-1 focus:ring-red-500"})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("label",{className:"block text-[11px] font-semibold text-slate-200",children:"IIT email"}),(0,a.jsx)("input",{type:"email",value:e.email,disabled:!0,className:"w-full cursor-not-allowed rounded-lg border border-slate-700 bg-slate-900 px-3 py-2 text-sm text-slate-400"})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("label",{className:"block text-[11px] font-semibold text-slate-200",children:"Student type"}),(0,a.jsx)("input",{value:e.studentType,disabled:!0,className:"w-full cursor-not-allowed rounded-lg border border-slate-700 bg-slate-900 px-3 py-2 text-sm text-slate-400"})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("label",{className:"block text-[11px] font-semibold text-slate-200",children:"Program / Major"}),(0,a.jsx)("input",{type:"text",value:d,onChange:e=>u(e.target.value),className:"w-full rounded-lg border border-slate-700 bg-slate-950 px-3 py-2 text-sm text-slate-100 outline-none focus:border-red-500 focus:ring-1 focus:ring-red-500"})]}),(0,a.jsx)("button",{type:"submit",disabled:g,className:"mt-2 inline-flex items-center justify-center rounded-lg bg-red-600 px-4 py-2 text-sm font-semibold text-white shadow-sm shadow-red-900/40 hover:bg-red-500 disabled:cursor-not-allowed disabled:bg-red-300",children:g?"Saving changes…":"Save profile"})]})]}):(0,a.jsx)("p",{className:"text-sm text-red-300",children:"Could not load profile. Please log in again."})}},3145:function(e,t,l){"use strict";l.d(t,{default:function(){return r.a}});var a=l(8461),r=l.n(a)},8461:function(e,t,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var l in t)Object.defineProperty(e,l,{enumerable:!0,get:t[l]})}(t,{default:function(){return i},getImageProps:function(){return n}});let a=l(7043),r=l(5346),s=l(5878),o=a._(l(5084));function n(e){let{props:t}=(0,r.getImgProps)(e,{defaultLoader:o.default,imgConf:{deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!1}});for(let[e,l]of Object.entries(t))void 0===l&&delete t[e];return{props:t}}let i=s.Image},5523:function(e,t,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"RouterContext",{enumerable:!0,get:function(){return a}});let a=l(7043)._(l(2265)).default.createContext(null)}},function(e){e.O(0,[878,971,117,744],function(){return e(e.s=7844)}),_N_E=e.O()}]);