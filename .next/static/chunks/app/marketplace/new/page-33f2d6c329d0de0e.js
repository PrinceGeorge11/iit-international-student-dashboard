(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[818],{6981:function(e,t,r){Promise.resolve().then(r.bind(r,9461))},9461:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return g}});var s=r(7437),a=r(2265),l=r(9376),n=r(9178),i=r(9205);let o=(0,i.Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);var c=r(2720);let d=(0,i.Z)("CloudUpload",[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]]),u=(0,i.Z)("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);var x=r(7648);let h=["Textbooks","Furniture & Room","Electronics & Accessories","Kitchen","Clothing","Other"],m=["IIT Main Campus (Mies)","Downtown Campus","Online / Remote","Other"],p="dzzznohpr",f="istudentshub_marketplace";function g(){let e=(0,l.useRouter)(),[t,r]=(0,a.useState)(""),[i,g]=(0,a.useState)(""),[b,j]=(0,a.useState)(""),[v,y]=(0,a.useState)("Textbooks"),[w,N]=(0,a.useState)("Like New"),[k,C]=(0,a.useState)("IIT Main Campus (Mies)"),[I,_]=(0,a.useState)(""),[S,T]=(0,a.useState)(null),[E,L]=(0,a.useState)(!1),[P,A]=(0,a.useState)(!1),O=async e=>{var t,r;T(null);let s=null===(t=e.target.files)||void 0===t?void 0:t[0];if(s){if(!p||!f){T("Cloudinary is not configured. Please set NEXT_PUBLIC_CLOUDINARY_CLOUD_NAME and NEXT_PUBLIC_CLOUDINARY_UPLOAD_PRESET in .env.local.");return}A(!0);try{let e=new FormData;e.append("file",s),e.append("upload_preset",f);let t=await fetch("https://api.cloudinary.com/v1_1/".concat(p,"/image/upload"),{method:"POST",body:e});if(!t.ok){let e=await t.json().catch(()=>({}));throw Error((null===(r=e.error)||void 0===r?void 0:r.message)||"Image upload failed. Try a smaller file.")}let a=await t.json();if(!a.secure_url)throw Error("No secure_url returned from Cloudinary.");_(a.secure_url)}catch(e){console.error("Upload error:",e),T(e.message||"Failed to upload image. Please try a smaller file.")}finally{A(!1)}}},R=async r=>{if(r.preventDefault(),T(null),!t||!i||!b){T("Title, description, and price are required.");return}if(P){T("Please wait for the image upload to finish.");return}L(!0);try{let r=await fetch("/api/marketplace/products",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:t,description:i,price:b,category:v,condition:w,campus:k,imageUrl:I})}),s=await r.json();if(!r.ok)throw Error(s.error||"Failed to create listing");e.push("/marketplace")}catch(e){T(e.message||"Something went wrong")}finally{L(!1)}};return(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)(x.default,{href:"/marketplace",className:"inline-flex items-center gap-1 text-[11px] text-slate-300 hover:text-slate-100",children:[(0,s.jsx)(o,{className:"h-3 w-3"}),"Back to marketplace"]}),(0,s.jsxs)(n.Z,{children:[(0,s.jsxs)("header",{className:"mb-3 flex items-center gap-2",children:[(0,s.jsx)("span",{className:"inline-flex h-7 w-7 items-center justify-center rounded-full bg-red-600/20 text-red-300 ring-1 ring-red-500/40",children:(0,s.jsx)(c.Z,{className:"h-4 w-4"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-sm font-semibold text-slate-50",children:"List an item for IIT students"}),(0,s.jsx)("p",{className:"text-xs text-slate-400",children:"Share a used textbook, furniture, or other items with the IIT international student community."})]})]}),(0,s.jsxs)("form",{onSubmit:R,className:"space-y-3 text-xs",children:[(0,s.jsxs)("div",{className:"grid gap-3 md:grid-cols-2",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-[11px] text-slate-200",children:"Item title *"}),(0,s.jsx)("input",{type:"text",className:"mt-1 w-full rounded-lg border border-slate-700 bg-slate-950 px-3 py-2 text-xs text-slate-100 focus:border-red-500 focus:outline-none focus:ring-1 focus:ring-red-500",placeholder:"e.g. Intro to Programming Textbook, Twin Bed Frame",value:t,onChange:e=>r(e.target.value)})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-[11px] text-slate-200",children:"Price (USD) *"}),(0,s.jsx)("input",{type:"number",min:"0",step:"0.01",className:"mt-1 w-full rounded-lg border border-slate-700 bg-slate-950 px-3 py-2 text-xs text-slate-100 focus:border-red-500 focus:outline-none focus:ring-1 focus:ring-red-500",placeholder:"e.g. 25.00",value:b,onChange:e=>j(e.target.value)})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-[11px] text-slate-200",children:"Category"}),(0,s.jsx)("select",{className:"mt-1 w-full rounded-lg border border-slate-700 bg-slate-950 px-2 py-2 text-xs text-slate-100 focus:border-red-500 focus:outline-none focus:ring-1 focus:ring-red-500",value:v,onChange:e=>y(e.target.value),children:h.map(e=>(0,s.jsx)("option",{value:e,children:e},e))})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-[11px] text-slate-200",children:"Condition"}),(0,s.jsxs)("select",{className:"mt-1 w-full rounded-lg border border-slate-700 bg-slate-950 px-2 py-2 text-xs text-slate-100 focus:border-red-500 focus:outline-none focus:ring-1 focus:ring-red-500",value:w,onChange:e=>N(e.target.value),children:[(0,s.jsx)("option",{value:"New",children:"New"}),(0,s.jsx)("option",{value:"Like New",children:"Like New"}),(0,s.jsx)("option",{value:"Very Good",children:"Very Good"}),(0,s.jsx)("option",{value:"Good",children:"Good"}),(0,s.jsx)("option",{value:"Fair",children:"Fair"})]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-[11px] text-slate-200",children:"Campus / pickup location"}),(0,s.jsx)("select",{className:"mt-1 w-full rounded-lg border border-slate-700 bg-slate-950 px-2 py-2 text-xs text-slate-100 focus:border-red-500 focus:outline-none focus:ring-1 focus:ring-red-500",value:k,onChange:e=>C(e.target.value),children:m.map(e=>(0,s.jsx)("option",{value:e,children:e},e))})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-[11px] text-slate-200",children:"Description *"}),(0,s.jsx)("textarea",{className:"mt-1 min-h-[120px] w-full rounded-lg border border-slate-700 bg-slate-950 px-3 py-2 text-xs text-slate-100 focus:border-red-500 focus:outline-none focus:ring-1 focus:ring-red-500",placeholder:"Give details about the item, its condition, whatâ€™s included, and how you prefer to meet on campus.",value:i,onChange:e=>g(e.target.value)})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-[11px] text-slate-200",children:"Item photo (optional)"}),(0,s.jsxs)("div",{className:"mt-1 flex items-center gap-2",children:[(0,s.jsxs)("label",{className:"inline-flex cursor-pointer items-center gap-2 rounded-lg bg-slate-900 px-3 py-2 text-[11px] font-medium text-slate-100 ring-1 ring-slate-700 hover:bg-slate-800",children:[(0,s.jsx)(d,{className:"h-4 w-4"}),(0,s.jsx)("span",{children:P?"Uploading...":"Choose image file"}),(0,s.jsx)("input",{type:"file",accept:"image/*",className:"hidden",onChange:O,disabled:P})]}),I&&(0,s.jsx)("span",{className:"inline-flex h-8 w-8 items-center justify-center overflow-hidden rounded-lg bg-slate-900 ring-1 ring-slate-700",children:(0,s.jsx)("img",{src:I,alt:"Preview",className:"h-full w-full object-cover"})}),!I&&!P&&(0,s.jsx)("span",{className:"inline-flex h-8 w-8 items-center justify-center rounded-lg bg-slate-900 text-slate-400 ring-1 ring-slate-700",children:(0,s.jsx)(u,{className:"h-4 w-4"})})]}),(0,s.jsx)("p",{className:"mt-1 text-[9px] text-slate-500",children:"Images are uploaded to Cloudinary using an unsigned upload preset and linked to this listing via a public URL."})]})]})]}),S&&(0,s.jsxs)("p",{className:"text-[10px] text-red-300",children:["Error: ",S]}),(0,s.jsxs)("div",{className:"flex items-center justify-between pt-2 text-[10px]",children:[(0,s.jsx)("p",{className:"text-slate-500",children:"By listing an item, you agree to meet safely on campus and follow IIT/istudentshub guidelines."}),(0,s.jsx)("button",{type:"submit",disabled:E||P,className:"inline-flex items-center justify-center rounded-lg bg-red-600 px-4 py-2 text-[11px] font-semibold text-white shadow-sm shadow-red-900/40 hover:bg-red-500 disabled:cursor-not-allowed disabled:bg-red-900",children:E?"Creating listing...":P?"Uploading image...":"Create listing"})]})]})]})]})}},9178:function(e,t,r){"use strict";r.d(t,{Z:function(){return l}});var s=r(7437),a=r(1994);function l(e){let{children:t,className:r}=e;return(0,s.jsx)("div",{className:(0,a.W)("rounded-2xl border border-slate-500/90 bg-slate-200/80 p-4 shadow-lg shadow-black/40",r),children:t})}},9205:function(e,t,r){"use strict";r.d(t,{Z:function(){return o}});var s=r(2265);let a=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),l=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()};var n={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let i=(0,s.forwardRef)((e,t)=>{let{color:r="currentColor",size:a=24,strokeWidth:i=2,absoluteStrokeWidth:o,className:c="",children:d,iconNode:u,...x}=e;return(0,s.createElement)("svg",{ref:t,...n,width:a,height:a,stroke:r,strokeWidth:o?24*Number(i)/Number(a):i,className:l("lucide",c),...x},[...u.map(e=>{let[t,r]=e;return(0,s.createElement)(t,r)}),...Array.isArray(d)?d:[d]])}),o=(e,t)=>{let r=(0,s.forwardRef)((r,n)=>{let{className:o,...c}=r;return(0,s.createElement)(i,{ref:n,iconNode:t,className:l("lucide-".concat(a(e)),o),...c})});return r.displayName="".concat(e),r}},2720:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(9205).Z)("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]])},7648:function(e,t,r){"use strict";r.d(t,{default:function(){return a.a}});var s=r(2972),a=r.n(s)},9376:function(e,t,r){"use strict";var s=r(5475);r.o(s,"usePathname")&&r.d(t,{usePathname:function(){return s.usePathname}}),r.o(s,"useRouter")&&r.d(t,{useRouter:function(){return s.useRouter}})},1994:function(e,t,r){"use strict";function s(){for(var e,t,r=0,s="",a=arguments.length;r<a;r++)(e=arguments[r])&&(t=function e(t){var r,s,a="";if("string"==typeof t||"number"==typeof t)a+=t;else if("object"==typeof t){if(Array.isArray(t)){var l=t.length;for(r=0;r<l;r++)t[r]&&(s=e(t[r]))&&(a&&(a+=" "),a+=s)}else for(s in t)t[s]&&(a&&(a+=" "),a+=s)}return a}(e))&&(s&&(s+=" "),s+=t);return s}r.d(t,{W:function(){return s}}),t.Z=s}},function(e){e.O(0,[972,971,117,744],function(){return e(e.s=6981)}),_N_E=e.O()}]);